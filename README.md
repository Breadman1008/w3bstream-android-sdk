# W3bstream Android SDK

The W3bstream Android SDK is a framework that enables connecting data generated by devices and machines in the physical world to the blockchain world using the IoTeX blockchain. W3bStream uses a network of decentralized gateways (W3bStream nodes) to stream encrypted data from IoT devices and machines and create proofs of real-world events on different blockchains. For documentation and APIs, please visit the project [website](https://mainnet.w3bstream.com/). 

## Getting started
To get started, follow these steps:
1. Open the website [https://mainnet.w3bstream.com/](https://mainnet.w3bstream.com/)
2. Create your project on the website
3. Generate your publisher key and token
4. Consult the help document at [https://docs.w3bstream.com/introduction/readme](https://docs.w3bstream.com/introduction/readme)

### Setting up the dependency
The latest release is available on [Maven Central](https://search.maven.org/artifact/com.w3bstream/w3bstream-android/1.0/aar).

```
    implementation 'com.w3bstream:w3bstream-android:1.0.1'
```

### Initialization
In your app, initialize the SDK with your project values as shown below:
```
    val url = "https://api.w3bstream.com/srv-applet-mgr/v0/event/yourprojectname"
    val w3bStream by lazy {
        W3bStream.build(HttpService(url))
    }
```

### Make the payload
Create the payload in JSON format and then encode it as Base64, as shown below:
```
    val latitude = 31.8912140
    val longitude = 108.7645030
    val timestamp = System.currentTimeMillis() / 1000
    val json = """
        {
            "latitude": latitude,
            "longitude": longitude,
            "timestamp": timestamp
        }
    """
    val encodedPayload = Base64.getEncoder().encodeToString(json.toByteArray())
```

### Publish event to Webstream server by https
To publish events to the W3bstream server via HTTPS, use the following code:
```   
    val eventId = System.currentTimeMillis().toString() //Created by the developer
    val eventType = "ANY" //Created by the developer.
    val publisherId = "Your publisher id"
    val publisherToken = "Your publisher token"
    val pubTime = System.currentTimeMillis()
    
    val event = Event(Header(eventId, eventType, publisherId, pubTime, publisherToken), encodedPayload)

    val response = w3bStream.publishEvent(listof<Event>())
```
